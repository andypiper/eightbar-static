<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>code &#8211; eightbar</title>
	<atom:link href="http://eightbar.co.uk/tag/code/feed/" rel="self" type="application/rss+xml" />
	<link>http://eightbar.co.uk</link>
	<description>Raising The Eight Bar</description>
	<lastBuildDate>Sun, 26 Jun 2016 13:46:56 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.5.3</generator>
	<item>
		<title>Watson Rock, Paper, Scissors</title>
		<link>http://eightbar.co.uk/2016/06/26/watson-rock-paper-scissors/</link>
		<pubDate>Sun, 26 Jun 2016 13:46:56 +0000</pubDate>
		<dc:creator><![CDATA[Dale Lane]]></dc:creator>
				<category><![CDATA[Planet]]></category>
		<category><![CDATA[bluemix]]></category>
		<category><![CDATA[code]]></category>
		<category><![CDATA[eightbar]]></category>
		<category><![CDATA[IBM]]></category>
		<category><![CDATA[kids]]></category>
		<category><![CDATA[watson]]></category>

		<guid isPermaLink="false">http://dalelane.co.uk/blog/?p=3349</guid>
		<description><![CDATA[A simple hands-on activity to let kids train a machine learning classifier to be able to play Rock, Paper, Scissors. I&#8217;ve written and spoken before that I think we should do more to introduce children to the idea of machine learning. And I&#8217;ve tried introducing my two kids to it, such as by making a [&#8230;] <a href="http://eightbar.co.uk/2016/06/26/watson-rock-paper-scissors/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p><strong>A simple hands-on activity to let kids train a machine learning classifier to be able to play Rock, Paper, Scissors.</strong></p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27305758384/in/dateposted-public/" title="Screen Shot 2016-06-26 at 13.59.20"><img style="border: thin black solid" src="https://c1.staticflickr.com/8/7663/27305758384_2405bce9f2.jpg" width="450" height="282" alt="Screen Shot 2016-06-26 at 13.59.20"/></a></p>
<p>I&#8217;ve <a href="http://dalelane.co.uk/blog/?p=3299">written</a> and <a href="http://www.stemtechconference.com/past-events/conference-2015/showcase">spoken</a> before that I think we should do more to introduce children to the idea of machine learning. And I&#8217;ve tried introducing my two kids to it, such as by making a <a href="http://dalelane.co.uk/blog/?tag=codeclub">Code Club</a>-style game with them: we built <a href="http://dalelane.co.uk/blog/?p=3330">a system to play Guess Who</a>, that they trained both to understand what you say and to recognise the characteristics of faces from photos.</p>
<p>This weekend, we tried out another idea &#8211; <strong>Rock, Paper, Scissors</strong> from a web app, using the web cam to see your moves, and training a system to recognise your hand signs. </p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27815450382/in/dateposted-public/" title="DSC06146"><img src="https://c7.staticflickr.com/8/7086/27815450382_a385ddcda6.jpg" width="450" height="223" alt="DSC06146"/></a></p>
<p>In many ways, this was simpler than the Guess Who project, and one I would&#8217;ve tried before if we&#8217;d thought of it! I&#8217;ve made getting the system to choose it&#8217;s next move very simple, as it just chooses one of the three options at random.</p>
<p>The machine learning element comes from the fact that I got them to train a custom image classifier to recognise what a &#8216;rock&#8217;, &#8216;paper&#8217; and &#8216;scissors&#8217; hand sign looks like.</p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27916785445/in/dateposted-public/" title="DSC06153"><img src="https://c6.staticflickr.com/8/7346/27916785445_9772591bc2.jpg" width="450" height="299" alt="DSC06153"/></a></p>
<p>Last night I hacked together <a href="https://watson-rock-paper-scissors.eu-gb.mybluemix.net/">a quick single-page training web app</a> for them to use. Unlike with the Guess Who game, where we worked on it together to come up with the project, this time I made it myself to see how they&#8217;d get on with using it. (I was thinking that if it went well, I&#8217;d try using it with one of my school groups). </p>
<p>They got off to a good start&#8230; although I hadn&#8217;t counted on how much time Grace would spend checking out her hair once she saw the web cam video. <img src="https://s.w.org/images/core/emoji/72x72/1f642.png" alt="&#x1f642;" class="wp-smiley" style="height: 1em; max-height: 1em;" /> </p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/PJW19emo6J8?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/PJW19emo6J8">Video of the kids getting started</a></small></p>
<p>I&#8217;ve got it so that you can take photos from the web cam by clicking on a button, and put the photo into one of three training groups &#8211; one each for rock, paper and scissors. </p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27304547304/in/dateposted-public/" title="DSC06150"><img src="https://c1.staticflickr.com/8/7720/27304547304_772252bc55.jpg" width="450" height="299" alt="DSC06150"/></a></p>
<p>My hope was that the three hand signs &#8211; a fist, a flat palm, and two fingers &#8211; are distinct enough that an image classifier could quickly start to distinguish between them. </p>
<p>Although I should probably add some overlay to the live video to suggest where to put your hand, how close to the camera, etc. as their initial attempts were fairly inconsistent.</p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/7KrEHEx9Hbk?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/7KrEHEx9Hbk">Video of their first attempt at training</a></small></p>
<p>As before, I&#8217;m using one of the <a href="https://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/">Watson developer APIs</a> available in <a href="https://bluemix.net/">Bluemix</a>, called <a href="https://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition.html">Visual Recognition</a>. </p>
<p>To train it, you just need to upload zip files, where each zip file contains examples of photos of something you want to recognise. </p>
<p>In this case, we want to upload three zip files &#8211; one of photos of &#8220;rock&#8221;, one zip file of &#8220;paper&#8221; photos, one zip file of photos of &#8220;scissors&#8221;. And you can do all of that in <a href="https://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition/api/v3/#create_a_classifier">a single HTTP POST</a>, so the code behind the training app is very simple. </p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27840011881/in/dateposted-public/" title="DSC06152"><img src="https://c2.staticflickr.com/8/7506/27840011881_cbe882f7e7.jpg" width="450" height="257" alt="DSC06152"/></a></p>
<p>That said, I should still share the code. </p>
<p>It was hacked together in an evening, so it&#8217;s a complete mess. But I&#8217;ll try and find some spare time this week to tidy it up, and put the code somewhere in case it&#8217;s helpful. Some of the code for driving the webcam, zipping up the photos, and uploading them, might be useful to someone. </p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/O7z2yXTWKo0?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/O7z2yXTWKo0">The first test</a></small></p>
<p>To test it, I made a simple game. I&#8217;ve got it keeping score to see how many moves you win against the random choices the game makes. Although Grace seemed more interested in counting the number of times the game correctly identified our moves. It wasn&#8217;t perfect!</p>
<p>(The &#8220;Watson&#8217;s move&#8221; images used in the game bit were made by Faith. She took photos of her own hand using an iPad, and did the weird grid background effect using <a href="http://www.mixcord.co/partners/popagraph.html">PopAGraph</a>. It wasn&#8217;t quite what I expected, but I think it looks kinda neat.) </p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27305736804/in/dateposted-public/" title="Screen Shot 2016-06-26 at 13.57.16"><img style="border: thin black solid" src="https://c5.staticflickr.com/8/7448/27305736804_94efff066f.jpg" width="500" height="313" alt="Screen Shot 2016-06-26 at 13.57.16"/></a></p>
<p>As with the <a href="http://dalelane.co.uk/blog/?p=3330">Guess Who activity</a>, what most interested me was the girls&#8217; reactions to the behaviour of the ML system. I was surprised that even after last time, their initial assumption was still that they could take one photo of each, and that would be enough. (Another reason why it&#8217;s worth doing a few of these activities to reinforce it). </p>
<p>But with a little nudging, they quickly saw how that the more examples they gave, the better the system performed. </p>
<p>Other than that, a lot of the lessons they learned were reminders of <a href="http://dalelane.co.uk/blog/?p=3330">what we talked about before</a> about what it&#8217;s like doing supervised learning projects. </p>
<p><iframe width="450" height="338" src="https://www.youtube.com/embed/vYxDD37Jqn8?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/vYxDD37Jqn8">The second attempt&#8230; another test after more training this time</a></small></p>
<p>One thing I was impressed with was when they thought that the training would be more effective if they used an actual rock, actual scissors, and a sheet of paper. Doing that made the accuracy a hundred times better. That makes sense, as they are much more distinct than all photos of hands, so that was a neat idea!</p>
<p>And that&#8217;s pretty much it. My second experiment at getting the kids to play with machine learning seemed to work pretty well. </p>
<p>I&#8217;ve put the app I made for them up on Bluemix so you&#8217;re welcome to give it a try it you like. It&#8217;s at <a href="https://watson-rock-paper-scissors.eu-gb.mybluemix.net/">https://watson-rock-paper-scissors.eu-gb.mybluemix.net</a>. </p>
<p>You&#8217;ll have to <a href="https://console.ng.bluemix.net/catalog/services/visual-recognition/">get your own Visual Recognition API key</a> to use it, though, but that supports a free trial, so hopefully that won&#8217;t put you off!</p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/ecBc2OG407M?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/ecBc2OG407M">Third time lucky? Another test</a></small></p>
<hr />
<strong>Update 1:</strong> 
<p>A couple of friends pointed me at <a href="https://developer.ibm.com/clouddataservices/2015/12/01/humans-vs-apache-spark-building-our-rock-paper-scissors-game/">another recent IBM rock, paper, scissors project</a> when I mentioned planning to do this. </p>
<p>It looks like a great project and is well worth a look &#8211; they&#8217;ve gone into using Apache Spark to create a system able look for patterns in how people play rock-paper-scissors and learn strategies to win the game. </p>
<p>More recently, they&#8217;ve even gotten <a href="https://developer.ibm.com/dwblog/games-humans-vs-apache-spark/">a NAO robot to play the game</a> for them!</p>
<p>I wasn&#8217;t aware of this work before, but decided to go ahead with our project anyway. Partly because my focus was different for this, but mostly because I think that the <a href="http://www.cgpgrey.com/blog/letter-to-jake-on-the-agonies-of-parallel-creation">Agonies of Parallel Creation</a> should never stop us from creating and sharing stuff. There&#8217;s no new idea under the sun, so if we wait for an idea that no-one has ever got close to, we&#8217;d stop creating anything. </p>
<p>That said, it&#8217;s a particularly surreal coincidence in this case, as this is not only an IBM project, but the author of that post is the great <a href="https://twitter.com/dtaieb55">David Taieb</a> who I used to work for when he worked on Watson! Small world. </p>
<hr />
<strong>Update 2:</strong> 
<p>Yes, I know you can see my API key in the video. But don&#8217;t worry. Bluemix makes it easy enough to revoke credentials so I&#8217;ve deleted that API key. Doing that was much quicker than learning enough video editing to be able to mask it out. <img src="https://s.w.org/images/core/emoji/72x72/1f642.png" alt="&#x1f642;" class="wp-smiley" style="height: 1em; max-height: 1em;" /> </p>
<p><script async src="http://embedr.flickr.com/assets/client-code.js" charset="utf-8"></script></p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/dalelane/27916796025/in/dateposted-public/" title="DSC06149"><img src="https://c2.staticflickr.com/8/7177/27916796025_517a1ecd51.jpg" width="450" height="279" alt="DSC06149"/></a></p>
<br clear=all/><div style="font-size: small; padding: 0px 10px 0px 10px; border: 1px solid #ccc; color: #333; background-color: #eee;"><a href="http://dalelane.co.uk/blog/?p=3349">"Watson Rock, Paper, Scissors"</a> was posted by <a href="http://dalelane.co.uk/blog/">Dale Lane</a> to <a href="http://dalelane.co.uk/blog/?p=3349">http://dalelane.co.uk/blog/?p=3349</a>.<br /><em>Feed footer idea <a href="http://www.43folders.com/feedfooter">nicked from 43 Folders</a> using the <a href="http://www.scratch99.com/wordpress-plugin-feedentryheader/">FeedEntryHeader WordPress plugin</a>.</em></div>]]></content:encoded>
	<enclosure url="" length="" type="" />
		</item>
		<item>
		<title>An introduction to machine learning with Guess Who</title>
		<link>http://eightbar.co.uk/2016/02/18/an-introduction-to-machine-learning-with-guess-who/</link>
		<pubDate>Thu, 18 Feb 2016 18:50:40 +0000</pubDate>
		<dc:creator><![CDATA[Dale Lane]]></dc:creator>
				<category><![CDATA[Planet]]></category>
		<category><![CDATA[code]]></category>
		<category><![CDATA[eightbar]]></category>
		<category><![CDATA[IBM]]></category>
		<category><![CDATA[kids]]></category>

		<guid isPermaLink="false">http://dalelane.co.uk/blog/?p=3330</guid>
		<description><![CDATA[I tried introducing my two kids to machine learning by helping them make a game this week. In this post, I&#8217;ll try and explain why, how we did it, and how it went. And if you make it all the way to an end, I&#8217;ve got some videos and a link to a demo to [&#8230;] <a href="http://eightbar.co.uk/2016/02/18/an-introduction-to-machine-learning-with-guess-who/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p><strong>I tried introducing my two kids to machine learning by helping them make a game this week. </strong></p>
<p>In this post, I&#8217;ll try and explain why, how we did it, and how it went. And if you make it all the way to an end, I&#8217;ve got some videos and a link to a demo to show you what we made.</p>
<h3>Why</h3>
<p>I think we need to introduce the basic concept of machine learning to children.</p>
<p>I think the current approach to introducing coding using things like <a href="http://dalelane.co.uk/blog/?tag=scratch">Scratch</a> aren&#8217;t enough. This isn&#8217;t to say Scratch isn&#8217;t great (I&#8217;ve been running a <a href="http://dalelane.co.uk/blog/?tag=codeclub">Code Club</a> every week for the last couple of years, delivered almost entirely using Scratch, so I&#8217;d be the last person to say it isn&#8217;t a fantastic tool). It lets you snap together blocks representing actions to teach the programming mindset of getting a computer to do something by you breaking the task down into a series of steps.</p>
<p>I think we need to add to this with something that introduces the model of machine learning &#8211; getting a computer to do something by training it with examples of doing that task.</p>
<p><img src="http://dalelane.co.uk/blog/post-images/150428-slides/image-0055.jpg" style="border: thin black solid"/></p>
<p>I&#8217;ve been saying this for a while &#8211; I gave a talk about it at <a href="http://www.stemtechconference.com/past-events/conference-2015/showcase">an education conference</a> last year, I&#8217;ve <a href="http://dalelane.co.uk/blog/?p=3299">written about it</a> here before, and it was the theme of a <a href="https://twitter.com/dalelane/status/690250594813153280">lecture I gave at a science society</a> in London last month.</p>
<p>This week is half-term and I have the week off work, so I thought I&#8217;d finally spend a bit of time trying it out by experimenting on my own two daughters (Faith and Grace, who are aged 7 and 11).</p>
<p>In Code Club, I mostly try to introduce programming concepts by helping the kids to create games. Sticking with what seems to work, I&#8217;ve helped them to make a game by training an ML system how to play it.</p>
<h3>How</h3>
<p>We&#8217;ve been making a sort of <a href="https://en.wikipedia.org/wiki/Guess_Who%3F">Guess Who?</a> game &#8211; a game that I&#8217;ve played with the kids for years and that they know inside out. </p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/generationbass/5686663807" title="Guess-Who-Closeup.jpg"><img src="https://farm6.staticflickr.com/5223/5686663807_da29ff3852.jpg" width="448" height="368" alt="Guess-Who-Closeup.jpg"/></a><script async src="http://embedr.flickr.com/assets/client-code.js" charset="utf-8"></script></p>
<p>The idea is that the computer shows a bunch of faces and chooses one of them at random. You have to work out which one it&#8217;s chosen by asking Yes/No questions about their appearance.</p>
<p>I introduced this to Grace and Faith mostly using analogies and anthropomorphising. </p>
<blockquote><p>&#8220;We need to teach the computer how to play the game instead of telling it how to&#8221;.</p></blockquote>
<blockquote><p>&#8220;We&#8217;ll do it the same way that you teach a small child to do something, not by telling it the series of steps to take but by showing it examples of how it should be done, over and over, until it learns how to do it&#8221;.</p></blockquote>
<p>And so on.</p>
<p>I went with a couple of opportunities for trying out machine learning approaches.</p>
<p><strong>Understanding the question</strong></p>
<p>As a player, we let you <strong>ask questions in natural language</strong>. You&#8217;ve just got a text box to type in anything you want to ask. In practice though, there&#8217;s a reasonably predictable set of questions you might ask &#8211; it&#8217;s a very constrained domain. So it lends itself well to <strong>using a text classifier</strong>.</p>
<p>I got the kids to make a list of all the types of questions they ask in a Guess Who game. These were the <em>classes</em> we&#8217;d train the system with (e.g. &#8220;has brown hair&#8221; or &#8220;is wearing a hat&#8221;). Then for each class, they had to come up with as many ways as they could think of to ask that question.</p>
<p><img src="http://dalelane.co.uk/blog/post-images/20160217-nlc.jpg" alt="the kids using Watson NLC" style="border: thin black solid"/></p>
<p>We used this to train <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/nl-classifier.html">IBM Watson Natural Language Classifier</a>.</p>
<p>I chose it mostly because I&#8217;m familiar with it, it&#8217;s a hosted readily available service so there was nothing to install or configure, it has a simple web interface for training that the kids could use to enter the classes and texts they thought of, and for this sort of kicking-the-tyres-with-minimal-usage it&#8217;s free.</p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/h1ZiUIvYdD8?rel=0" frameborder="0" allowfullscreen></iframe></p>
<p>With a little training, they had a trained classifier that would be able to take a question from the player and map it to one of the classes they&#8217;d come up with for the questions they ask when they play Guess Who.</p>
<p><strong>Answering the question</strong></p>
<p>The next step was to train the system to be able to answer the questions. We needed it to be able to <strong>recognise visual characteristics in a photo</strong>. Again, this is a constrained domain, although less so than for classifying questions. But still, this was basically <strong>a classifying task</strong>, albeit with the extra challenge of using images.</p>
<p>We looked for a collection of face images that we could use, both for training, and for the game itself. We initially started trying out <a href="http://www.info.polymtl.ca/~mdhas/LWF/">Labeled Wikipedia Faces</a>, but ultimately settled on using <a href="http://vis-www.cs.umass.edu/lfw/">Labeled Faces in the Wild</a> &#8211; a set of over 13,000 photos of faces.</p>
<p><img src="http://dalelane.co.uk/blog/post-images/20160217-visrec.jpg" alt="Grace, preparing the training for Visual Recognition" style="border: thin black solid"/></p>
<p>I got the kids to group examples of the faces based on the characteristics they’d come up with in their list of text classes. We just used the built-in OSX Finder to do this. </p>
<p>One folder open on the left with all the unsorted faces in, and a bunch of folders open to the right &#8211; e.g. &#8220;short-hair&#8221;, &#8220;long-hair&#8221;, &#8220;bald&#8221;, &#8220;hat&#8221;. They scrolled through the unsorted pictures, and trained by dragging the photos across into the relevant folder.</p>
<p>We used an IBM Watson API with this, too : <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/visual-recognition.html">IBM Watson Visual Recognition</a> </p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/F6oaA6fauzY?rel=0" frameborder="0" allowfullscreen></iframe></p>
<p>Again, I chose it because I’m familiar with it, and it’s a hosted service I didn’t need to install or run, and while it’s in beta it’s all free to use.</p>
<p><strong>Putting it all together</strong></p>
<p>While they did that, I hacked together up a quick game to drive it. They were in charge of training, I wrote a simple REST API to make the requests to the Watson APIs, and a UI to let the player interact with it.</p>
<p>We had our game!</p>
<p><img src="http://dalelane.co.uk/blog/post-images/20160217-guesswho.jpg" style="border: thin black solid"/></p>
<h3>How it went</h3>
<p>I asked them what they&#8217;d learned from doing it, and they came up with things like:</p>
<blockquote><p><strong>&#8220;You need a lot of training data&#8221;</strong></p></blockquote>
<p>When I explained how we&#8217;d train the visual recognition classifiers to recognise characteristics in photos, Faith said &#8220;We could take photos of each other and use those!&#8221;. I said that we&#8217;d need more than that, so she said &#8220;I could take photos of my friends as well!&#8221;.</p>
<p>But we needed so many more than that. We started by looking to <a href="http://www.info.polymtl.ca/~mdhas/LWF/">Wikipedia</a> (always a good starting point for getting data!), before eventually settling on <a href="http://vis-www.cs.umass.edu/lfw/">the LFW set</a>.</p>
<p>Getting them to help me find the training data gave them an idea of the sort of scale you need for these sorts of projects, as well as giving them an insight into ideas like gathering existing data rather than trying to manually create it.</p>
<blockquote><p><strong>&#8220;The more training you give it, the better it gets&#8221;</strong></p></blockquote>
<p>We did this project off-and-on throughout half-term week rather than all in one sitting. And we re-ran the training after each go. It was really clear the way that the results improved the more that we did.</p>
<p>I&#8217;m a big fan of learning by doing, and I think that seeing that for themselves was more effective than if I&#8217;d just told them. Trying it out with virtually no training, and seeing that it&#8217;s rubbish. Then trying it out with a bit of training, and see it start to get better. Then trying it again after a few days and see it really improving &#8211; there was a definite light bulb moment.</p>
<blockquote><p><strong>&#8220;Training is fun at first, but can get a bit boring after a while&#8221;</strong></p></blockquote>
<p>This was more an issue with the visual recognition training rather than the NLC text classifier training. Even after the first afternoon they&#8217;d already come up with a classifier that was doing a decent job of most questions. But grouping the photos into the training sets took much longer. And to be honest, it really needs more training than they did if you wanted to turn this into a proper demo or game &#8211; I let them do enough to get the idea, but stopped them before it became a miserable chore!</p>
<p>But this was a positive thing. As a takeaway, that&#8217;s a really valid and valuable insight. I&#8217;ve seen commercial ML projects fail to recognise this at the outset! Training ML systems is a repetitive, manual and very time-consuming task that does get boring for the people involved.</p>
<p>We talked about ways that people try and get around that, like trying to turn it into a game. Grace thought that if we did this as a school activity, with all her class helping out with the training, then split between 30 kids, it wouldn&#8217;t take as long.</p>
<p>All of these points &#8211; the amount of time and work needed to train, approaches like getting a large number of people to train, etc. &#8211; these are all great lessons about the practicalities of using machine learning.</p>
<blockquote><p><strong>&#8220;It&#8217;s a bit like magic&#8221;</strong></p></blockquote>
<p>If you had to describe the steps involved in working out if a photo included a face that has a moustache, that would be pretty complicated. But dividing 100 photos into two groups &#8211; faces with a moustache, and faces without a moustache &#8211; that&#8217;s easy.</p>
<p>There were a bunch of things they talked about here that was really positive &#8211; that doing this is easy, and you don&#8217;t need you to understand the deep detail behind how it works. With Faith (my youngest) we didn&#8217;t go into too much detail about how the training works, but Grace and I did find some videos on YouTube that explained the principles behind deep learning which were interesting.</p>
<p>More generally, what I wanted them to learn was that computers can spot patterns in data, without you needing to be able to specify rules that they should follow. And I think that&#8217;s a more effective lesson as something they saw and did for themselves rather than just reading or hearing about it.</p>
<h3>The result</h3>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/oguzXlRT4NQ?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/Z3UReJzzY4Q">https://youtu.be/oguzXlRT4NQ</a></small></p>
<p>I&#8217;ve put what we came up with on Bluemix at <a href="http://guesswho.eu-gb.mybluemix.net/">http://guesswho.eu-gb.mybluemix.net</a></p>
<p>I&#8217;ve also put some more videos below to show us trying it out.</p>
<p>As I explained above, it&#8217;s not really &#8220;finished&#8221; &#8211; I think it needs more training, and the UI was hacked together in a hurry. But even as a quick half-term project, I think it already shows a glimmer of what is possible.</p>
<p>More importantly, it shows that you can give kids a hands-on introduction to machine learning.</p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/1AkSVBzE5io?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/Z3UReJzzY4Q">https://youtu.be/1AkSVBzE5io</a></small></p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/6ay7MqhW53g?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/Z3UReJzzY4Q">https://youtu.be/6ay7MqhW53g</a></small></p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/Z3UReJzzY4Q?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/Z3UReJzzY4Q">https://youtu.be/Z3UReJzzY4Q</a></small></p>
<p><iframe width="450" height="253" src="https://www.youtube.com/embed/GNcz_D62_0w?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="https://youtu.be/Z3UReJzzY4Q">https://youtu.be/GNcz_D62_0w</a></small></p>
<br clear=all/><div style="font-size: small; padding: 0px 10px 0px 10px; border: 1px solid #ccc; color: #333; background-color: #eee;"><a href="http://dalelane.co.uk/blog/?p=3330">"An introduction to machine learning with Guess Who"</a> was posted by <a href="http://dalelane.co.uk/blog/">Dale Lane</a> to <a href="http://dalelane.co.uk/blog/?p=3330">http://dalelane.co.uk/blog/?p=3330</a>.<br /><em>Feed footer idea <a href="http://www.43folders.com/feedfooter">nicked from 43 Folders</a> using the <a href="http://www.scratch99.com/wordpress-plugin-feedentryheader/">FeedEntryHeader WordPress plugin</a>.</em></div>]]></content:encoded>
	<enclosure url="" length="" type="" />
		</item>
		<item>
		<title>How to use the IBM Watson Relationship Extraction service on Bluemix</title>
		<link>http://eightbar.co.uk/2015/01/25/how-to-use-the-ibm-watson-relationship-extraction-service-on-bluemix/</link>
		<pubDate>Sun, 25 Jan 2015 20:18:54 +0000</pubDate>
		<dc:creator><![CDATA[Dale Lane]]></dc:creator>
				<category><![CDATA[Planet]]></category>
		<category><![CDATA[bluemix]]></category>
		<category><![CDATA[code]]></category>
		<category><![CDATA[eightbar]]></category>
		<category><![CDATA[IBM]]></category>
		<category><![CDATA[nodejs]]></category>
		<category><![CDATA[watson]]></category>

		<guid isPermaLink="false">http://dalelane.co.uk/blog/?p=3272</guid>
		<description><![CDATA[Before Christmas, I wrote about how I used the Watson Relationship Extraction service on Bluemix to pick out the things mentioned in news stories, as part of a mobile app we built on a hackday. I&#8217;d still like to do something more with that app, but in the meantime I should at least share how [&#8230;] <a href="http://eightbar.co.uk/2015/01/25/how-to-use-the-ibm-watson-relationship-extraction-service-on-bluemix/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p>Before Christmas, I wrote about how <a href="http://dalelane.co.uk/blog/?p=3261">I used the Watson Relationship Extraction service on Bluemix to pick out the things mentioned in news stories</a>, as part of a <a href="https://www.youtube.com/watch?v=vBCz31arNxw">mobile app we built on a hackday</a>. I&#8217;d still like to do something more with that app, but in the meantime I should at least share how I did the Relationship Extraction bit. </p>
<p>From the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/relationship-extraction.html">official doc for the service</a>:</p>
<blockquote><p>From unstructured text, Relationship Extraction can extract entities (such as people, locations, organizations, events), and the relationships between these entities (such as person employed-by organization, person resides-in location).</p></blockquote>
<p>This is provided as a hosted service on <a href="http://bluemix.net/">IBM Bluemix</a> where any developer can sign up and give it a try. </p>
<p>It&#8217;s available as a <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/doc/sireapi/">documented REST API</a>, but as part of using it in the hackday, I needed to write a bit of code around that, just to prepare the request and parse the response. I think it&#8217;ll save me time to reuse this the next time I want to build something with the API, so I&#8217;m <a href="https://github.com/dalelane/extract-relationships">sharing it as a standalone package</a>. </p>
<p>In this post, I&#8217;ll walk though how you can use it, with a small app that grabs the contents of a BBC News story and picks out the names of people mentioned in the story. </p>
<p>First, a simpler example. Consider this exciting text:</p>
<blockquote><p>Dale Lane works as a developer for IBM. He started in 2003. Dale lives in the UK, in a town called Eastleigh. Before that, he was a student at the University of Bath.</p></blockquote>
<p>A few lines of Javascript are enough to run that through the service. </p>
<pre style="border: thin solid silver; background-color: #eeeeee; padding: 0.7em; font-size: 1.2em; overflow: auto;">var text = '';
var watson = require('extract-relationships');
watson.extract(text, function(err, response) {
    // response has got all the info  
});</pre>
<p>The <a href="https://gist.github.com/dalelane/223500f2eae708fe34ef">full contents of <code>response</code></a> is in a gist if you want to see it, but I&#8217;ll show just a few examples here to give you the idea. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-01.jpg" alt='screenshot'/></p>
<p>It has picked out all of the references to me, recognising that they are all describing a person, and that &#8216;developer&#8217; is my occupation. </p>
<p>The &#8216;begin&#8217; and &#8216;end&#8217; numbers tell you where in the text each bit was found. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-02.jpg" alt='screenshot'/></p>
<p>It&#8217;s picked out the reference to IBM, and recognised that this is a name of a commercial organisation. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-03.jpg" alt='screenshot'/></p>
<p>It&#8217;s recognised that &#8216;2003&#8217; is a reference to a date. </p>
<p>As well as identifying those entities and many others, it&#8217;s also picked out the relationships between them. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-04.jpg" alt='screenshot'/></p>
<p>For example, it&#8217;s identified the relationship between me and IBM. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-05.jpg" alt='screenshot'/></p>
<p>And the relationship between me and my old University. </p>
<p>I&#8217;ve written a more <a href="https://github.com/dalelane/extract-relationships#interpreting-the-output">detailed breakdown of what is contained in the response</a> including how to find out what each of the fields mean, and what the different possible values for each one are. </p>
<p>That&#8217;s the basics with a few input sentences. Next, we start throwing a lot of text at it. </p>
<p>In about <a href="https://github.com/dalelane/extract-relationships/blob/master/examples/newspeople.js">thirty lines of Javascript</a>, you can download the text from a news story on the BBC News website, and pick out the names of all of the people mentioned in the story. </p>
<p><script src="https://gist.github.com/dalelane/2571821221f177643d05.js"></script></p>
<p>If you <a href="https://github.com/dalelane/extract-relationships/blob/master/examples/newspeople.js">run that simple example</a>, you get the <a href="https://github.com/dalelane/extract-relationships/blob/master/examples/newspeople.js#L94">list of people</a> that are included in the story text. </p>
<p>Where it starts to get interesting is when you combine this with other sources and APIs. </p>
<p>For example, once you&#8217;ve picked out the names of people from the story, try looking up their profiles on Wikipedia, and finding out who they are. </p>
<p>Or, instead of people, pick out the names of places from news stories, and use a geocoding API to plot them on a map. (<em>There are geocoding services available on Bluemix, too, if that helps.</em>)</p>
<p>Hopefully you can see how you could start to use this in your own apps. </p>
<p>Finally, some practical points. </p>
<p><strong>How do you <a href="https://www.npmjs.com/package/extract-relationships">install the package</a> I&#8217;ve shared so you can use it?</strong></p>
<pre style="border: thin solid silver; background-color: #eeeeee; padding: 0.7em; font-size: 1.2em; overflow: auto;">npm install --save extract-relationships</pre>
<p><strong>How do you configure it for the Watson Relationship Extraction Service?</strong></p>
<p>The API we&#8217;re using is an authenticated service hosted in IBM Bluemix, so there is a tiny bit of config you need to do first before you can use it.</p>
<p>If you&#8217;re <a href="https://github.com/dalelane/extract-relationships#bluemix">running your app in Bluemix</a>, then there isn&#8217;t much to do. Add the Relationship Extraction service to your app from the Bluemix dashboard, and the endpoint and credentials will automatically be provided and should just work. </p>
<p>If you&#8217;re <a href="https://github.com/dalelane/extract-relationships#running-outside-bluemix">running your app on your own machine</a>, there are a couple of extra steps instead. </p>
<p>Go to <a href="http://bluemix.net/">Bluemix</a>. Sign up for an account if you haven&#8217;t already got on</p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-06.jpg" alt='screenshot'/></p>
<p>From the dashboard, create an app. You need something as a placeholder to bind the Relationship Extraction service to, even if you don&#8217;t use it. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-07.jpg" alt='screenshot'/></p>
<p>Create a web app and give it a name. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-08.jpg" alt='screenshot'/></p>
<p>Add a service. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-09.jpg" alt='screenshot'/></p>
<p>Choose the Relationship Extraction service from the group of Watson services. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-10.jpg" alt='screenshot'/></p>
<p>Click on &#8216;Show Credentials&#8217;. Everything you need to configure your app is in here. You need the url, username and password. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/150125-screenshot-11.jpg" alt='screenshot'/></p>
<p>Copy this into an <a href="https://github.com/dalelane/extract-relationships#options">options object</a> like this:</p>
<pre style="border: thin solid silver; background-color: #eeeeee; padding: 0.7em; font-size: 1.2em; overflow: auto;">var options = {
    api : {
        url : 'https://url.of.your.watson.service...',
        user : 'your-watson-service-username',
        pass : 'your-watson-service-password'
    }
};</pre>
<p>To reiterate, this isn&#8217;t the username and password that you use to sign in to Bluemix. It&#8217;s the username and password specifically for this service that Bluemix has generated for your app. </p>
<p>It&#8217;s not a good idea to hard-code passwords in your code, so I&#8217;d suggest putting them outside of your app and grabbing them in when needed. Environment variables are an easy way to do this, and are what I&#8217;ve done in <a href="https://github.com/dalelane/extract-relationships/tree/master/examples">the few samples I&#8217;ve written</a>. </p>
<p>That&#8217;s all there is to it. </p>
<p>I&#8217;ve put more info on <a href="https://github.com/dalelane/extract-relationships">github</a> with the <a href="https://github.com/dalelane/extract-relationships/blob/master/index.js">source for how I&#8217;m using the API</a>. </p>
<br clear=all/><div style="font-size: small; padding: 0px 10px 0px 10px; border: 1px solid #ccc; color: #333; background-color: #eee;"><a href="http://dalelane.co.uk/blog/?p=3272">"How to use the IBM Watson Relationship Extraction service on Bluemix"</a> was posted by <a href="http://dalelane.co.uk/blog/">Dale Lane</a> to <a href="http://dalelane.co.uk/blog/?p=3272">http://dalelane.co.uk/blog/?p=3272</a>.<br /><em>Feed footer idea <a href="http://www.43folders.com/feedfooter">nicked from 43 Folders</a> using the <a href="http://www.scratch99.com/wordpress-plugin-feedentryheader/">FeedEntryHeader WordPress plugin</a>.</em></div>]]></content:encoded>
	<enclosure url="" length="" type="" />
		</item>
		<item>
		<title>Watson News Companion</title>
		<link>http://eightbar.co.uk/2014/12/12/watson-news-companion/</link>
		<pubDate>Fri, 12 Dec 2014 16:52:31 +0000</pubDate>
		<dc:creator><![CDATA[Dale Lane]]></dc:creator>
				<category><![CDATA[Planet]]></category>
		<category><![CDATA[code]]></category>
		<category><![CDATA[eightbar]]></category>
		<category><![CDATA[hack]]></category>
		<category><![CDATA[hackday]]></category>
		<category><![CDATA[IBM]]></category>
		<category><![CDATA[watson]]></category>

		<guid isPermaLink="false">http://dalelane.co.uk/blog/?p=3261</guid>
		<description><![CDATA[We recently ran a hackathon at work: people within IBM were invited to try building a mobile app aimed at consumers using Watson services. It was a fun chance to try out some new ideas, as well as to build something using our APIs &#8211; dogfooding is always a good thing. I worked on a [&#8230;] <a href="http://eightbar.co.uk/2014/12/12/watson-news-companion/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p><a href="https://www.flickr.com/photos/dalelane/16004789072" title="screenshot on Flickr"><img align="right" hspace=10 vspace=10 src="https://farm9.staticflickr.com/8613/16004789072_c4beb842c3_n.jpg" width="183" height="320" alt="newscompanion screenshot"/></a>We recently ran a hackathon at work: people within IBM were invited to try building a mobile app aimed at consumers using <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/services-catalog.html">Watson services</a>. It was a fun chance to try out some new ideas, as well as to build something using our APIs &#8211; dogfooding is always a good thing. </p>
<p>I worked on a hack with <a href="https://twitter.com/davidgeorgeuk">David</a> which we submitted on Wednesday. This is what we came up with, and how we built it. </p>
<p><strong>The idea</strong></p>
<p>A mobile app that will help users to digest the news by explaining references in stories and providing greater context. </p>
<p><strong>Background</strong></p>
<p>It&#8217;s difficult to find the time nowadays to properly read and understand what&#8217;s going on in the world. We rarely have the time to sit and read through a newspaper. Instead, we might quickly read news stories online from our smartphones and tablets. But that often makes it difficult to understand the broader context that a story is in. There might be references in the story to people, places, organisations or events that are unfamiliar. </p>
<p>Watson could help. It could be an assistant as you read the news, explaining unfamiliar references and the broader context. </p>
<p><strong>Features</strong></p>
<p>Our Watson News Companion demo is a mobile news reader app that:</p>
<ul>
<li>anticipates questions and suggests areas where it can help improve understanding
</li>
<li>provides answers to questions without needing the users to lose their place in the story
</li>
<li>allow the user to dig deeper with their own follow-up questions
</li>
</ul>
<p><iframe width="450" height="253" src="http://www.youtube.com/embed/vBCz31arNxw?rel=0" frameborder="0" allowfullscreen></iframe><br />
<small><a href="http://youtu.be/vBCz31arNxw">A video walkthrough of the hack</a></small></p>
<p><strong>Implementation</strong></p>
<p>The hack was built as a mobile web app using the <a href="http://mean.io/">MEAN stack</a>: using <a href="http://expressjs.com/">express</a> as the framework on a <a href="http://nodejs.org/">Node.js</a> platform, storing some information in a <a href="http://www.mongodb.org/">MongoDB</a> and building the UI with <a href="https://angularjs.org/">AngularJS</a>. </p>
<p>It uses RSS feeds from news websites to fetch content, which are shown in a simple newsreader app built using <a href="http://goratchet.com/">Ratchet</a>. </p>
<p>The contents of the story is run through the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/relationship-extraction.html">Watson Relationship Extraction API</a> to pick out the people, places, organisations, and other entities mentioned in the story. </p>
<p>The <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/doc/sireapi/#exampleOutput">API output</a> includes co-references, to identify the multiple mentions of the same entity. These are combined and reviewed, and together with the type of the entity are used to generate likely questions about the entity. </p>
<p>These questions are sent to the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/question-answer.html">Watson Question and Answer API</a>. For questions which are returned with answers with a high confidence, annotations are added inline to the news story. Pressing the annotation brings up a sliding panel at the bottom of the screen with the answer to the question. The links and footer annotations are built using <a href="http://www.bigfootjs.com/">bigfoot</a>.</p>
<p>Every screen in the app also includes an &#8220;Ask Watson&#8221; button which lets the user enters any free text question to let them dig deeper into what they&#8217;ve read. </p>
<p><strong>Could you build this?</strong></p>
<p>This was a proof-of-concept built in a hurry, so we&#8217;re not calling this a finished app. But everything we used is freely available &#8211; both to people inside IBM and the public. </p>
<p>We developed on an instance of Bluemix (our <a href="http://www.cloudfoundry.org/">Cloud Foundry</a>-based development platform) available internally within IBM. You can sign up for free to a public instance of Bluemix at <a href="http://bluemix.net/">bluemix.net</a>. </p>
<p>The technologies used to build the hack are all freely available : Node.js, MongoDB, AngularJS, Ratchet, bigfoot, jQuery.</p>
<p>A beta version of the Watson Relationship Extraction API is <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/getstarted.html">freely available for apps hosted on Bluemix</a>.</p>
<p>A beta version of the Watson Question and Answer API is freely available for apps hosted on Bluemix. But this is a <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/doc/qaapi/">demo instance of Watson</a> that has only read a small number of general healthcare documents. That&#8217;s not a useful corpus for our hack, so to record our demo we stood up our own instance &#8211; using an untrained instance of Watson which we gave a small subset of Wikipedia to read. We used the Question and Answer API on this instance instead of the Bluemix one. For people outside IBM to do this, they need to sign up to join the <a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/ecosystem.html">Watson Ecosystem</a>. This is also free, but there are criteria for who is eligible at this point, and an application process to go through. </p>
<br clear=all/><div style="font-size: small; padding: 0px 10px 0px 10px; border: 1px solid #ccc; color: #333; background-color: #eee;"><a href="http://dalelane.co.uk/blog/?p=3261">"Watson News Companion"</a> was posted by <a href="http://dalelane.co.uk/blog/">Dale Lane</a> to <a href="http://dalelane.co.uk/blog/?p=3261">http://dalelane.co.uk/blog/?p=3261</a>.<br /><em>Feed footer idea <a href="http://www.43folders.com/feedfooter">nicked from 43 Folders</a> using the <a href="http://www.scratch99.com/wordpress-plugin-feedentryheader/">FeedEntryHeader WordPress plugin</a>.</em></div>]]></content:encoded>
	<enclosure url="" length="" type="" />
		</item>
		<item>
		<title>Text analytics in BlueMix using UIMA</title>
		<link>http://eightbar.co.uk/2014/04/13/text-analytics-in-bluemix-using-uima/</link>
		<pubDate>Sun, 13 Apr 2014 21:41:14 +0000</pubDate>
		<dc:creator><![CDATA[Dale Lane]]></dc:creator>
				<category><![CDATA[Planet]]></category>
		<category><![CDATA[bluemix]]></category>
		<category><![CDATA[cloudfoundry]]></category>
		<category><![CDATA[code]]></category>
		<category><![CDATA[eightbar]]></category>
		<category><![CDATA[uima]]></category>

		<guid isPermaLink="false">http://dalelane.co.uk/blog/?p=3073</guid>
		<description><![CDATA[In this post, I want to explain how to create a text analytics application in BlueMix using UIMA, and share sample code to show how to get started. First, some background if you&#8217;re unfamiliar with the jargon. What is UIMA? UIMA (Unstructured Information Management Architecture) is an Apache framework for building analytics applications for unstructured [&#8230;] <a href="http://eightbar.co.uk/2014/04/13/text-analytics-in-bluemix-using-uima/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p>In this post, I want to explain <strong>how to create a text analytics application in BlueMix using UIMA</strong>, and share <a href="http://uimahelloworld.mybluemix.net/">sample code to show how to get started</a>.  </p>
<p>First, some background if you&#8217;re unfamiliar with the jargon. </p>
<p><strong>What is UIMA?</strong></p>
<p><a href="http://uima.apache.org/">UIMA</a> (Unstructured Information Management Architecture) is an Apache framework for building analytics applications for unstructured information and the OASIS standard for content analytics. </p>
<p>I&#8217;ve <a href="http://dalelane.co.uk/blog/?tag=uima">written about it before</a>, having used it on <a href="http://cv.dalelane.co.uk/index.php/employment/ets/projects/">a few projects when I was in ETS</a>, and on other side projects since such as building <a href="http://dalelane.co.uk/blog/?p=2277">a conversational interface to web pages</a>. </p>
<p>It&#8217;s perhaps better known for providing the architecture for the question answering system <a href="http://ibmwatson.com/">IBM Watson</a>. </p>
<p><strong>What is BlueMix?</strong></p>
<p><img src="http://dalelane.co.uk/blog/post-images/140413-bluemixlogo.jpg" hspace=10 vspace=10 border=0 align="left"/><a href="http://bluemix.net/">BlueMix</a> is IBM&#8217;s new Platform-as-a-Service (PaaS) offering, built on top of <a href="http://cloudfoundry.org/">Cloud Foundry</a> to provide a cloud development platform. </p>
<p>It&#8217;s in open beta at the moment, so you can sign up and have a play. </p>
<p>I&#8217;ve never used BlueMix before, or Cloud Foundry for that matter, so this was a chance for me to write my first app for it. </p>
<p><strong>A UIMA &#8220;Hello World&#8221; for BlueMix</strong></p>
<p>I&#8217;ve written a small sample to show how UIMA and BlueMix can work together. It provides a REST API that you can submit text to, and get back a JSON response with some attributes found in the text (long words, capitalised words, and strings that look like email addresses). </p>
<p>The &#8220;analytics&#8221; that the app is doing is trivial at best, but this is just a Hello World. For now my aim isn&#8217;t to produce a useful analytics solution, but to walk through the configuration needed to define a UIMA analytics pipeline, wrap it in a REST API using <a href="http://wink.apache.org/">Wink</a>, and deploy it as a BlueMix application. </p>
<p>When I get a chance, I&#8217;ll write a follow-up post on making something more useful. </p>
<p>You can try out the sample on BlueMix as it&#8217;s deployed to <a href="http://uimahelloworld.mybluemix.net/">bluemix.net</a> </p>
<p>The source is on GitHub at <a href="https://github.com/dalelane/bluemixuima">github.com/dalelane/bluemixuima</a>. </p>
<p>In the rest of this post, I&#8217;ll walk through some of the implementation details. </p>
<p><strong>Runtimes and services</strong></p>
<p>Creating an application in BlueMix is already <a href="http://bluemix.net/docs">well documented</a> so I won&#8217;t reiterate those steps, other than to say that as Apache UIMA is a Java SDK and framework, I use the <strong>Liberty for Java</strong> runtime. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/140413-bluemixruntime.png" border=0 vspace=5/></p>
<p>I&#8217;m not using any of the services in this simple sample. </p>
<p><strong>Manifest</strong></p>
<p>The app is bundled up in a war file, which is what we deploy. This is specified in <a href="https://github.com/dalelane/bluemixuima/blob/master/manifest.yml">manifest.yml</a>.</p>
<p><strong>Building</strong></p>
<p>The war file is built by an <a href="https://github.com/dalelane/bluemixuima/blob/master/build.xml">ant task</a> which has to <a href="https://github.com/dalelane/bluemixuima/blob/master/build.xml#L16">include the UIMA jar in the classpath</a>, and <a href="https://github.com/dalelane/bluemixuima/blob/master/build.xml#L49">copy my UIMA descriptor XML files into the war</a>. </p>
<p>I&#8217;m developing in eclipse, so I set up an <a href="https://github.com/dalelane/bluemixuima/blob/master/.externalToolBuilders/BlueMix%20builder.launch">ant builder to run the build</a>, and <a href="https://github.com/dalelane/bluemixuima/blob/master/.project">configured the project to do it automatically</a>. </p>
<p>I&#8217;m deploying from eclipse, too, using the <a href="http://dist.springsource.com/release/TOOLS/cloudfoundry">Cloud Foundry plugins for eclipse</a>. </p>
<p><strong>XML descriptors</strong></p>
<p>The type system is defined in <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/typeSystemDescriptor.xml">an XML descriptor file</a> and specifies the different annotations that can be created by this pipeline, and the attributes that they have. </p>
<p>Running JCasGen in eclipse on that descriptor generates <a href="https://github.com/dalelane/bluemixuima/tree/master/src/com/dalelane/uima/bluemixhelloworld/annotations">Java classes representing those types</a>. </p>
<p>The pipeline is also defined in XML descriptors: one <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/aggregateAnalysisEngineDescriptor.xml">overall aggregate descriptor</a> which imports three primitive descriptors for each of the three annotators in my sample pipeline : <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/primitiveAeDescriptorEmailAddresses.xml">one to find email addresses</a>, <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/primitiveAeDescriptorWordCase.xml">one to find capitalised words</a> and <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/primitiveAeDescriptorWordLengths.xml">one to find long words</a>. </p>
<p>Note that <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/aggregateAnalysisEngineDescriptor.xml#L7">the imports in the aggregate descriptor</a> need to be relative so that they keep working once you deploy to BlueMix. </p>
<p>These XML descriptor files are all added to the war file by being included in the <a href="https://github.com/dalelane/bluemixuima/blob/master/build.xml#L49">build.xml with a fileset include</a>. </p>
<p><strong>Annotators</strong></p>
<p>Each of the primitive descriptor files <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/primitiveAeDescriptorEmailAddresses.xml#L5">specifies the fully qualified class name</a> for the Java implementation of the annotator. </p>
<p>There are <a href="https://github.com/dalelane/bluemixuima/tree/master/src/com/dalelane/uima/bluemixhelloworld/annotators">three annotators in this sample</a>. (XML files with names starting &#8220;primitiveAeDescriptor&#8221;).</p>
<p>Each one is <a href="https://github.com/dalelane/bluemixuima/tree/master/src/com/dalelane/uima/bluemixhelloworld/annotators">implemented by a Java class</a> that extends <a href="http://uima.apache.org/d/uimaj-2.5.0/apidocs/org/apache/uima/analysis_component/JCasAnnotator_ImplBase.html">JCasAnnotator_ImplBase</a>.</p>
<p>Each uses a regular expression to find things to annotate in the text. This isn&#8217;t intended to be an indication that this is how things should be done, just that it makes for a simple and stateless demonstration without any additional dependencies. </p>
<p>The simplest is the regex used to find capitalised words in <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/annotators/WordCaseAnnotator.java#L31">WordCaseAnnotator</a> and the most complex is the ridiculously painful one used to find email addresses in <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/annotators/EmailAnnotator.java#L33">EmailAnnotator</a>. </p>
<p>Note that the regexes are prepared in the <a href="http://uima.apache.org/d/uimaj-2.5.0/apidocs/org/apache/uima/analysis_component/AnalysisComponent_ImplBase.html#initialize(org.apache.uima.UimaContext)">annotator initializer</a>, and reused for each <a href="http://uima.apache.org/d/uimaj-2.5.0/apidocs/org/apache/uima/analysis_component/JCasAnnotator_ImplBase.html#process(org.apache.uima.jcas.JCas)">new CAS to process</a>, to improve performance. </p>
<p><strong>UIMA pipeline</strong></p>
<p>The UIMA pipeline is defined in <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java">a single Java class</a>. </p>
<p>It finds <a href="https://github.com/dalelane/bluemixuima/blob/master/com.dalelane.uima.bluemixhelloworld/aggregateAnalysisEngineDescriptor.xml">the XML descriptor for the pipeline</a> by <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java#L67">looking in the location where BlueMix will unpack the war</a>. </p>
<p>It <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java#L80">creates a CAS pool</a> to make it easier to handle multiple concurrent requests, and avoid the overhead of creating a CAS for every request.  </p>
<p>Once the pipeline is <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java#L83">initialised</a>, it is ready to <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java#L108">handle incoming analysis requests</a>. </p>
<p>Once the CAS has passed through the pipeline, <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java#L150">the annotations are immediately copied out of the CAS into a POJO</a>, so that the CAS can be returned to the pool. </p>
<p><strong>REST API</strong></p>
<p>The war file deployed to BlueMix contains a <a href="https://github.com/dalelane/bluemixuima/blob/master/WebContent/WEB-INF/web.xml#L7">web.xml which specifies the servlet</a> that implements the REST API.</p>
<p>I&#8217;m using <a href="http://wink.apache.org/">Wink</a> to implement the API. The servlet definition in the web.xml specifies <a href="https://github.com/dalelane/bluemixuima/blob/master/WebContent/WEB-INF/web.xml#L12">where to find the list of API endpoints</a> and the <a href="https://github.com/dalelane/bluemixuima/blob/master/WebContent/WEB-INF/web.xml#L18">URL where the API should be</a>.</p>
<p>The <a href="https://github.com/dalelane/bluemixuima/blob/master/WebContent/WEB-INF/resources">list of API endpoints</a> is a list of classes that Wink uses. There is only one API endpoint, so only one class listed. </p>
<p>The <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/api/UimaResource.java">API implementation</a> is a very thin wrapper around the <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/Pipeline.java">Pipeline class</a>. </p>
<p>Everything is defined using <a href="https://github.com/dalelane/bluemixuima/blob/master/src/com/dalelane/uima/bluemixhelloworld/api/UimaResource.java#L28">annotations</a>, and Wink handles turning the response into a JSON payload. </p>
<p><strong>That&#8217;s it</strong></p>
<p>I think that&#8217;s pretty much it. </p>
<p><a href="http://uimahelloworld.mybluemix.net/"><img src="http://dalelane.co.uk/blog/post-images/140413-samplescreenshot.png" border=0 vspace=5/></a></p>
<p>I&#8217;ve added a <a href="https://github.com/dalelane/bluemixuima/blob/master/WebContent/index.html">simple front-end webpage</a>, with <a href="https://github.com/dalelane/bluemixuima/blob/master/WebContent/apitester.js">a script to submit API requests</a> for people who don&#8217;t want to do it with something like curl. </p>
<p>It&#8217;s live at <a href="http://uimahelloworld.mybluemix.net/">uimahelloworld.mybluemix.net</a>.</p>
<p>Like I said, it&#8217;s very simple. The Java itself isn&#8217;t particularly complex. My reason for sharing it was to provide a boilerplate config for defining a UIMA analytics pipeline, wrapping it in a REST API, and deploying it to BlueMix. </p>
<p>Once you&#8217;ve got that working, you can do text analytics in BlueMix as complex as whatever you can dream up for your annotators. </p>
<p>When I get time, I&#8217;ll write a follow-up post sharing what that could look like. </p>
<br clear=all/><div style="font-size: small; padding: 0px 10px 0px 10px; border: 1px solid #ccc; color: #333; background-color: #eee;"><a href="http://dalelane.co.uk/blog/?p=3073">"Text analytics in BlueMix using UIMA"</a> was posted by <a href="http://dalelane.co.uk/blog/">Dale Lane</a> to <a href="http://dalelane.co.uk/blog/?p=3073">http://dalelane.co.uk/blog/?p=3073</a>.<br /><em>Feed footer idea <a href="http://www.43folders.com/feedfooter">nicked from 43 Folders</a> using the <a href="http://www.scratch99.com/wordpress-plugin-feedentryheader/">FeedEntryHeader WordPress plugin</a>.</em></div>]]></content:encoded>
	<enclosure url="" length="" type="" />
		</item>
		<item>
		<title>Smile!</title>
		<link>http://eightbar.co.uk/2012/04/03/smile/</link>
		<pubDate>Tue, 03 Apr 2012 22:29:32 +0000</pubDate>
		<dc:creator><![CDATA[Dale Lane]]></dc:creator>
				<category><![CDATA[Planet]]></category>
		<category><![CDATA[code]]></category>
		<category><![CDATA[eightbar]]></category>
		<category><![CDATA[face]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[webcam]]></category>

		<guid isPermaLink="false">http://dalelane.co.uk/blog/?p=2092</guid>
		<description><![CDATA[The visualisations on this page need Flash and Javascript. Apologies if that means most of this page doesn&#8217;t work for you! This is my mood (as identified from my facial expressions) over time while watching Never Mind the Buzzcocks. The green areas are times where I looked happy. This shows my mood while playing XBox [...] <a href="http://eightbar.co.uk/2012/04/03/smile/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p>This is my mood (as identified from my facial expressions) over time while watching <a href="http://www.bbc.co.uk/programmes/b006v0dz">Never Mind the Buzzcocks</a>. </p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationone.png"/></p>
<p>The green areas are times where I looked happy.</p>
<p>This shows my mood while playing XBox Live. Badly. </p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationtwo.png"/></p>
<p>The red areas are times where I looked cross. </p>
<p>I smile more while watching comedies than when getting shot in the head. Shocker, eh? </p>
<p>A couple of years ago, I played with the idea of <a href="http://dalelane.co.uk/blog/?p=1176">capturing my TV viewing habits and making some visualisations</a> from them. This is a sort of return to that idea in a way. </p>
<p>A webcam lives on the top of our TV, mainly for skype calls. I was thinking that when watching TV, we&#8217;re often more or less looking at the webcam. What could it capture? </p>
<p>What about keeping track of how much I smile while watching a comedy, as a way of measuring which comedies I find funnier? </p>
<p><img src="http://dalelane.co.uk/blog/post-images/120403-smiling1.jpg"/></p>
<p>This suggests that, overall, I might&#8217;ve found Mock the Week funnier. But, this shows my facial expressions while watching <a href="http://www.bbc.co.uk/programmes/b006t6vf">Mock the Week</a>. </p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationthree.png"/></p>
<p>It seems that, unlike with Buzzcocks, I really enjoyed the beginning bit, then perhaps got a bit less enthusiastic after a bit. </p>
<p>What about <a href="http://www.thedailyshow.com/">The Daily Show with Jon Stewart</a>?</p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationsix.png"/></p>
<p>I think the two neutral bits are breaks for adverts. </p>
<p>Or classifying facial expressions by mood and looking for the dominant mood while watching something more serious on TV? </p>
<p>This shows my facial expressions while catching a bit of <a href="http://www.bbc.co.uk/programmes/b006mk25">Newsnight</a>.</p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationfour.png"/></p>
<p>On the whole, my expression remained reasonably neutral whilst watching the news, but you can see where I visibly reacted to a few of the news items. </p>
<p>Or looking to see how I react to playing different games on the XBox?</p>
<p>This shows my facial expressions while playing Modern Warfare 3 last night.</p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationfive.png"/></p>
<p>Mostly &#8220;sad&#8221;, as I kept getting shot in the head. With occasional moments where something made me smile or laugh, presumably when something went well. </p>
<p>Compare that with what I looked like while playing Blur (a car racing game).</p>
<p><img src="http://i267.photobucket.com/albums/ii311/dale_lane/120403visualisationtwo.png"/></p>
<p>It seems that I looked a little more aggressive while driving than running around getting shot. For last night, at any rate. </p>
<p><strong>Not just about watching TV</strong></p>
<p>I&#8217;m using face recognition to tell my expressions apart from other people in the room. This means there is also a bunch of stuff I could look into around how my expressions change based on who else is in the room, and their expressions? </p>
<p>For example, looking at how much of the time I spend smiling when I&#8217;m the only one in the room, compared with when one or both of <a href="https://picasaweb.google.com/dale.lane">my kids</a> are in the room. </p>
<p><img src="http://dalelane.co.uk/blog/post-images/120403-smiling2.jpg"/></p>
<p>To be fair, this isn&#8217;t a scientific comparison. There are lots of factors here &#8211; for example, when the girls are in the room, I&#8217;ll probably be doing a different activity (such as playing a game with them or reading a story) to what I would be doing when by myself (typically doing some work on my laptop, or reading). This could be showing how much I smile based on which activity I&#8217;m doing. But I thought it was a cute result, anyway. </p>
<p><strong>Limitations</strong></p>
<p>This isn&#8217;t sophisticated stuff. </p>
<p>The webcam is an old, cheap one that only has a maximum resolution of 640&#215;480, and I&#8217;m sat at the other end of the room to it. I can&#8217;t capture fine facial detail here. </p>
<p>I&#8217;m not doing anything complicated with video feeds. I&#8217;m just sampling by taking photos at regular intervals. You could reasonably argue that the funniest joke in the world isn&#8217;t going to get me to sustain a broad smile for over a minute, so there is a lot being missed here. </p>
<p>And my y-axis is a little suspect. I&#8217;m using the percentage level of confidence that the classifier had in identifying the mood. I&#8217;m doing this on the assumption that the more confident the classifier was, the stronger or more pronounced my facial expression probably was. </p>
<p>Regardless of all of this, I think the idea is kind of interesting. </p>
<p><strong>How does it work?</strong></p>
<p>The <a href="http://dalelane.co.uk/blog/?p=1228">media server under the TV</a> runs Ubuntu, so I had a lot of options. My language-of-choice for quick hacks is Python, so I used <a href="http://www.pygame.org/">pygame</a> to capture stills from the webcam.</p>
<p>For the complicated facial stuff, I&#8217;m using <a href="http://developers.face.com/">web services from face.com</a>. </p>
<p>They have a REST API for uploading a photo to, getting back a blob of JSON with information about faces detected in the photo. This includes a guess at the gender, a description of mood from the facial expression, whether the face is smiling, and even an estimated age (often not complimentary!). </p>
<p>I used a <a href="https://github.com/chris-piekarski/python-face-client">Python client library from github</a> to build the requests, so getting this working took no time at all. </p>
<p>There is a face recognition REST API. You can train the system to recognise certain faces. I didn&#8217;t write any code to do this, as I don&#8217;t need to do it again, so I did this using the <a href="http://developers.face.com/tools/#faces/detect">API sandbox on the face.com website</a>. I gave it a dozen or so photos with my face in, which seemed to be more than enough for the system to be able to tell me apart from someone else in the room. </p>
<p>My monitoring code puts what it measures about me in one log, and what it measures about anyone else in a second &#8220;guest log&#8221;. </p>
<p>This is the result of one evening&#8217;s playing, so I&#8217;ve not really finished with this. I think there is more to do with it, but for what it&#8217;s worth, this is what I&#8217;ve come up with so far. </p>
<p><strong>The script</strong></p>
<pre style="border: thin solid silver; color: black; background-color: #eeeeee; padding: 0.7em; overflow: auto;">####################################################
#  IMPORTS
####################################################

# imports for capturing a frame from the webcam
import pygame.camera
import pygame.image

# import for detecting faces in the photo
import face_client

# import for storing data
from pysqlite2 import dbapi2 as sqlite

# miscellaneous imports
from time import strftime, localtime, sleep
import os
import sys

####################################################
# CONSTANTS
####################################################

DB_FILE_PATH="/home/dale/dev/audiencemonitor/data/log.db"
FACE_COM_APIKEY="MY_API_KEY_HERE"
FACE_COM_APISECRET="MY_API_SECRET_HERE"
DALELANE_FACETAG="dalelane@dale.lane"
POLL_FREQUENCY_SECONDS=3

class AudienceMonitor():

    #
    # prepare the database where we store the results
    #
    def initialiseDB(self):
        self.connection = sqlite.connect(DB_FILE_PATH, detect_types=sqlite.PARSE_DECLTYPES|sqlite.PARSE_COLNAMES)
        cursor = self.connection.cursor()

        cursor.execute('SELECT name FROM sqlite_master WHERE type="table" AND NAME="facelog" ORDER BY name')
        if not cursor.fetchone():
            cursor.execute('CREATE TABLE facelog(ts timestamp unique default current_timestamp, isSmiling boolean, smilingConfidence int, mood text, moodConfidence int)')

        cursor.execute('SELECT name FROM sqlite_master WHERE type="table" AND NAME="guestlog" ORDER BY name')
        if not cursor.fetchone():
            cursor.execute('CREATE TABLE guestlog(ts timestamp unique default current_timestamp, isSmiling boolean, smilingConfidence int, mood text, moodConfidence int, agemin int, ageminConfidence int, agemax int, agemaxConfidence int, ageest int, ageestConfidence int, gender text, genderConfidence int)')

        self.connection.commit()

    #
    # initialise the camera
    #
    def prepareCamera(self):
        # prepare the webcam
        pygame.camera.init()
        self.camera = pygame.camera.Camera(pygame.camera.list_cameras()[0], (900, 675))
        self.camera.start()

    #
    # take a single frame and store in the path provided
    #
    def captureFrame(self, filepath):
        # save the picture
        image = self.camera.get_image()
        pygame.image.save(image, filepath)

    #
    # gets a string representing the current time to the nearest second
    #
    def getTimestampString(self):
        return strftime("%Y%m%d%H%M%S", localtime())

    #
    # get attribute from face detection response
    #
    def getFaceDetectionAttributeValue(self, face, attribute):
        value = None
        if attribute in face['attributes']:
            value = face['attributes'][attribute]['value']
        return value

    #
    # get confidence from face detection response
    #
    def getFaceDetectionAttributeConfidence(self, face, attribute):
        confidence = None
        if attribute in face['attributes']:
            confidence = face['attributes'][attribute]['confidence']
        return confidence

    #
    # detects faces in the photo at the specified path, and returns info
    #
    def faceDetection(self, photopath):
        client = face_client.FaceClient(FACE_COM_APIKEY, FACE_COM_APISECRET)
        response = client.faces_recognize(DALELANE_FACETAG, file_name=photopath)
        faces = response['photos'][0]['tags']
        for face in faces:
            userid = ""
            faceuseridinfo = face['uids']
            if len(faceuseridinfo) &gt; 0:
                userid = faceuseridinfo[0]['uid']
            if userid == DALELANE_FACETAG:
                smiling = self.getFaceDetectionAttributeValue(face, "smiling")
                smilingConfidence = self.getFaceDetectionAttributeConfidence(face, "smiling")
                mood = self.getFaceDetectionAttributeValue(face, "mood")
                moodConfidence = self.getFaceDetectionAttributeConfidence(face, "mood")
                self.storeResults(smiling, smilingConfidence, mood, moodConfidence)
            else:
                smiling = self.getFaceDetectionAttributeValue(face, "smiling")
                smilingConfidence = self.getFaceDetectionAttributeConfidence(face, "smiling")
                mood = self.getFaceDetectionAttributeValue(face, "mood")
                moodConfidence = self.getFaceDetectionAttributeConfidence(face, "mood")
                agemin = self.getFaceDetectionAttributeValue(face, "age_min")
                ageminConfidence = self.getFaceDetectionAttributeConfidence(face, "age_min")
                agemax = self.getFaceDetectionAttributeValue(face, "age_max")
                agemaxConfidence = self.getFaceDetectionAttributeConfidence(face, "age_max")
                ageest = self.getFaceDetectionAttributeValue(face, "age_est")
                ageestConfidence = self.getFaceDetectionAttributeConfidence(face, "age_est")
                gender = self.getFaceDetectionAttributeValue(face, "gender")
                genderConfidence = self.getFaceDetectionAttributeConfidence(face, "gender")
                # if the face wasnt recognisable, it might've been me after all, so ignore
                if "tid" in face and face['recognizable'] == True:
                    self.storeGuestResults(smiling, smilingConfidence, mood, moodConfidence, agemin, ageminConfidence, agemax, agemaxConfidence, ageest, ageestConfidence, gender, genderConfidence)
                    print face['tid']

    #
    # stores face results in the DB
    #
    def storeGuestResults(self, smiling, smilingConfidence, mood, moodConfidence, agemin, ageminConfidence, agemax, agemaxConfidence, ageest, ageestConfidence, gender, genderConfidence):
        cursor = self.connection.cursor()
        cursor.execute('INSERT INTO guestlog(isSmiling, smilingConfidence, mood, moodConfidence, agemin, ageminConfidence, agemax, agemaxConfidence, ageest, ageestConfidence, gender, genderConfidence) values(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)',
                        (smiling, smilingConfidence, mood, moodConfidence, agemin, ageminConfidence, agemax, agemaxConfidence, ageest, ageestConfidence, gender, genderConfidence))
        self.connection.commit()

    #
    # stores face results in the DB
    #
    def storeResults(self, smiling, smilingConfidence, mood, moodConfidence):
        cursor = self.connection.cursor()
        cursor.execute('INSERT INTO facelog(isSmiling, smilingConfidence, mood, moodConfidence) values(?, ?, ?, ?)',
                        (smiling, smilingConfidence, mood, moodConfidence))
        self.connection.commit()

monitor = AudienceMonitor()
monitor.initialiseDB()
monitor.prepareCamera()
while True:
    photopath = "data/photo" + monitor.getTimestampString() + ".bmp"
    monitor.captureFrame(photopath)
    try:
        faceresults = monitor.faceDetection(photopath)
    except:
        print "Unexpected error:", sys.exc_info()[0]
    os.remove(photopath)
    sleep(POLL_FREQUENCY_SECONDS)</pre>
<br clear=all/><div style="font-size: small; padding: 0px 10px 0px 10px; border: 1px solid #ccc; color: #333; background-color: #eee;"><a href="http://dalelane.co.uk/blog/?p=2092">"Smile!"</a> was posted by <a href="http://dalelane.co.uk/blog/">Dale Lane</a> to <a href="http://dalelane.co.uk/blog/?p=2092">http://dalelane.co.uk/blog/?p=2092</a>.<br /><em>Feed footer idea <a href="http://www.43folders.com/feedfooter">nicked from 43 Folders</a> using the <a href="http://www.scratch99.com/wordpress-plugin-feedentryheader/">FeedEntryHeader WordPress plugin</a>.</em></div>]]></content:encoded>
			</item>
	</channel>
</rss>
